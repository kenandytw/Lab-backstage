@extends('frontend.layout')


@section('content')
<!-- privacy lightbox -->
        <div class="lightbox">

            <div class="lightbox-container">
                <div class="lightbox-header">
                    隱私權政策
                </div>

                <div class="lightbox-content">
                    <p>
                        無光晚餐官方網站 http://www.surpriselab.com.tw/dininginthedark（以下稱「無光晚餐網站」）為驚喜製造有限公司（以下稱「本公司」）所經營，無光晚餐網站尊重您的隱私權，並致力於保護您的個人資料。於使用無光晚餐網站前，請您詳細閱讀本條之「隱私權政策」（以下稱「本政策」），並隨時注意無光晚餐網站所公告之相關修改或變更，本公司有權於任何時間修改或變更本隱私權政策之內容。當您使用無光晚餐網站時，或於任何修改、變更後繼續使用無光晚餐網站，即表示您已閱讀、瞭解並同意接受本政策，或該等修改、變更後之內容，及同意無光晚餐網站依據本政策蒐集、處理與利用您的個人資料；如果您無法遵守或不同意本政策之內容，或您所屬的國家、地區排除本政策內容之全部或一部時，請您立即停止使用無光晚餐網站。此外，無光晚餐網站於未經您許可的情形下，絕不會將您的個人資料提供予任何第三方。
                    </p>
                    <p>
                        若您為未滿二十歲或無完全行為能力，除應符合上述規定外，請於您的法定代理人或監護人閱讀、瞭解並同意本政策及其後修改、變更後之所有內容後，方得使用或繼續使用無光晚餐網站，否則請立即停止使用無光晚餐網站。當您使用或繼續使用無光晚餐網站時，即視為您的法定代理人或監護人已閱讀、瞭解並同意接受本政策及其後修改、變更之所有內容。個人資料之類別：當您使用無光晚餐網站之服務，本公司會請您提供您下列類別的個人資料，如：<br>
                        辨識個人者（例如：姓名、住址、電子郵件信箱、行動電話）、<br>
                        辨識財務者（例如：信用卡或簽帳卡之號碼、銀行帳戶之號碼與姓名）、<br>
                        生活格調（例如：使用消費品之種類及服務之細節、個人之消費模式）、<br>
                        資料主體所取得之財貨或服務（例如：貨物或服務之有關細節）、<br>
                        財務交易（例如：收付金額、支付方式、往來紀錄）、<br>
                        資料主體之商業活動（例如：商業種類、提供或使用之財貨或服務、商業契約）、<br>
                        約定或契約（例如：關於交易、商業、法律或其他契約、代理）、<br>
                        未分類之資料（例如：用餐意見、無法歸類之檔案、報告），<br>
                        及其他任何得以直接或間接方式識別個人之資料等。<br>
                        惟請注意，您於無光晚餐網站中進行交易時，所輸入之信用卡卡號、有效日期及授權碼，均僅儲存於您個人之行動裝置中，無光晚餐網站將不會蒐集、處理或利用您上述個人資料。
                    </p>
                    <p> 
                        個人資料之利用：當您在無光晚餐網站登錄個人資料以進行相關交易時，所留下的個人資料包括但不限於姓名、電子郵件地址、手機號碼及發票寄送地址等，將在無光晚餐網站妥當的保存，無光晚餐網站所蒐集信用卡資訊或銀行資訊，均經使用安全的SSL加密協議處理，可確保您的隱私。

                    </p>
                    <p>
                        不提供個人資料之影響：您可自由選擇是否提供您上述的個人資料，但當您不同意提供時，您將無法享有無光晚餐網站所提供之服務。凡購買無光晚餐網站提供的服務或產品，本公司可能會透過電子郵件傳送您於無光晚餐網站的購買活動，包括但不限於消費者的帳戶、聯絡資訊或查詢、購買優惠的紀錄。您可選擇是否接收電子郵件，但當您不同意接收時，您將無法享有無光晚餐網站提供之服務。
                    </p>
                    <p>
                        個人資料利用之地區：本公司之個人資料主機、相關網路伺服器主機所在地及本公司∕無光晚餐網站相關服務或商品發行或行銷地區，為您個人資料利用之地區。
                    </p>
                    <p>
                        您對個人資料之權利：在不違反相關法律的情況下，於本公司確認該個人資料為您本人所有後，您可以撥打聯絡本公司∕無光晚餐網站，或將您的需求郵寄至本公司的電子郵件信箱，以行使下列之權利：(1)查詢、閱覽、補充或更正您的個人資料。(2)停止蒐集、處理或利用您的個人資料。(3)刪除您的個人資料。(4)提供您個人資料的複製本。(5)停止寄發給您無光晚餐網站相關廣告及行銷活動。但請注意，若您已於各該實際交易中提供您的個人資料給商家或交易對象，除法律另有規定之情形外，有關您的上述權利，應向各該商家或交易對象行使。
                    </p>

                    <p>
                        除下列情形外，本公司不會任意將用戶的個人資料出售、轉讓或揭露予任何第三人：(1)本公司在與其他第三人合辦或協辦活動時，與該第三人共用、傳遞您的資料，才能夠提供您要求的產品或服務。惟無光晚餐網站會於各該活動頁面明確告知您的個人資料將因參與該活動而提供予合辦或協辦之第三人，如您選擇參與該活動，即表示您瞭解並同意將該個人資料為各該活動之目的提供予合辦或協辦之第三人。(2)本公司∕無光晚餐網站將因法律規定、法院命令、行政調查或其他法律程序的要求而提供您的資料，惟在此情形下，該資料只會單純提供予調查單位，並受中華民國相關法律的保護。(3)為了調查和防止非法活動、涉嫌詐欺、對人身安全有潛在威脅的狀況、對本公司∕無光晚餐網站服務條款的違反，或為了對上述情形採取應對措施。(4) 無光晚餐網站或本公司被其他公司收購或合併，我們有權利將您的個人資料移轉給該公司。如果發生這種情況，無光晚餐網站會在您的個人資料被移轉且將適用不同的隱私權政策前通知您。

                    </p>
                    <p>
                        本公司∕無光晚餐網站有權隨時視實際情形修訂本政策，本政策有重大變更時，無光晚餐網站將張貼公告，您有義務隨時注意本政策有無更新或修訂。如您不同意所變更之內容，得隨時選擇退出相關服務，並請您立即停用無光晚餐網站之服務，如您繼續使用無光晚餐網站，即表示您同意本政策變更之內容。
                    </p>    
                </div>

                <div class="lightbox-cancel-container">
                    <a class="privacy-link" href="#">
                        <div class="btn btn-standard">
                            我瞭解了
                        </div>
                    </a>
                </div>
            </div>
        </div>
		<div class="section-02 reservation-section">
           
            <div class="reservation-nav">
                <ul>
                    <li class="active">
                        1
                    </li>
                    <li>
                        2
                    </li>
                    <li>
                        3
                    </li>
                    <li>
                        4
                    </li>
                    <li>
                        5
                    </li>
                </ul>
            </div>
           
            <div class="main-container" id="first-section">
                <p>
                    {{ trans('front.reservation.slug1title') }}
                </p>    
                {!! trans('front.reservation.slug1table') !!}
                <p style="margin-top:25px;">
                    <input id="agree" type="checkbox">
                    <label class="agree-check" for="agree"><span></span></label>
                    {{ trans('front.reservation.slug1agree') }}<a href="rules.html" target="_blank">{{ trans('front.reservation.slug1agrlink') }}</a>。
<span class="alert-wrap alert-show" id="agree-error" style="display: none;"><br /><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>{{ trans('front.reservation.slug1agAlert') }}</span>
                </p>
                <a href="javascript:;" id="first-btn">
                    <div class="btn btn-standard">
                        {{ trans('front.home.order') }}
                    </div>
                </a>
            </div>
            

            <div style="max-width:300px;display: none;" class="main-container" id="second-section">
                <table>
                    <tr>
                        <td>{{ trans('front.reservation.s2party') }}</td>
                    </tr>
                    <tr>
                        <td class="select-wrap">
                            <select name="Pople" id="Pople">
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="4">4</option>
                                <option value="6">6</option>
                            </select>
                        </td>
                    </tr>
                    <tr style="display: none;" id="PopleAlert">
                        <td>
                            <span class="alert-wrap alert-show">
                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                {{ trans('front.reservation.s2partyalert') }}
                            </span>
                        </td>
                    </tr>
                    <tr class="date_tr">
                        <td>{{ trans('front.reservation.s2date') }}</td>
                    </tr>
                    <tr class="date_tr">
                        <td>
                            <div class="form-group">
                                <div class="input-group date form_date" id="form_date">
                                    <input class="form-control" size="14" type="text" name="ADay" id="ADay" readonly>
                                    <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                        <span class="alert-wrap alert-show" style="color:#fff">
                        <i class="fa fa-exclamation-triangle"></i>
                            <span style="color:#81a7fd">藍色</span>為單人場次，<span style="color:#fa4b4b">紅色</span>為特別場次
                        </span>
                        </td>
                    </tr>
                    <tr style="display: none;" id="OneAlert">
                        <td>
                            <span class="alert-wrap alert-show">
                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                目前無1人場次
                            </span>
                        </td>
                    </tr>
                    <tr class="date_tr">
                        <td>{{ trans('front.reservation.s2time') }}</td>
                    </tr>
                    <tr class="date_tr">
                        <td class="select-wrap">
                            <select name="AID" id="AID"></select>
                        </td>
                    </tr>
                    <tr style="display: none;" id="AIDAlert">
                        <td>
                            <span class="alert-wrap alert-show">
                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                {{ trans('front.reservation.s2timealert') }}
                            </span>
                        </td>
                    </tr>
                </table>
                <a href="javascript:;" id="second-btn-back"><div class="btn btn-standard">{{ trans('front.reservation.prev') }}</div></a>
                <a href="javascript:;" id="second-btn"><div class="btn btn-standard">{{ trans('front.reservation.next') }}</div></a>
            </div>
            
            <div style="max-width:300px;display: none;" class="main-container" id="third-section">
                <table>
                    <tr>
                        <td>＊{{ trans('front.reservation.Name') }}</td>
                    </tr>
                    <tr>
                        <td>
                           <input type="text" name="Name" id="Name">
                        </td>
                    </tr>
                    <tr style="display: none;" id="NameAlert">
                        <td>
                            <span class="alert-wrap alert-show">
                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                {{ trans('front.reservation.NameAlert') }}
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>＊{{ trans('front.reservation.Tel') }}</td>
                    </tr>
                    <tr>
                        <td>
                            <input type="tel" name="Tel" id="Tel">
                        </td>
                    </tr>
                    <tr style="display: none;" id="TelAlert">
                        <td>
                            <span class="alert-wrap alert-show">

                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                {{ trans('front.reservation.TelAlert') }}
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>＊EMAIL</td>
                    </tr>
                    <tr>
                        <td>
                           <input type="email" name="EMail" id="EMail">
                        </td>
                    </tr>
                    <tr style="display: none;" id="EMailAlert">
                        <td>
                            <span class="alert-wrap alert-show">

                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                {{ trans('front.reservation.EMailAlert') }}
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>＊{{ trans('front.reservation.Main') }}</td>
                    </tr>
                    <tr>
                       <td>
                           <table id="MealTable"></table>
                       </td>
                    </tr>
                    <tr style="display: none;" id="MealAlert">
                        <td>
                            <span class="alert-wrap alert-show">

                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                請選擇主餐
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>{{ trans('front.reservation.Notes') }}</td>
                    </tr>
                    <tr>
                        <td>
                            <textarea rows="5" name="Notes" id="Notes"></textarea>
                        </td>
                    </tr>
                    <tr>
                        <td>{{ trans('front.reservation.Surprised') }}</td>
                    </tr>
                    <tr>
                        <td>
                            <textarea rows="5" name="Surprised" id="Surprised"></textarea>
                        </td>
                    </tr>
                    {!! trans('front.reservation.slug3ex') !!}
                    <tr>
                        <td></td>
                    </tr>
                    <tr>
                        <td>
                            <input id="privatecheck" type="checkbox">
                            <label class="agree-check" for="privatecheck"><span></span></label>
                            {!! trans('front.reservation.AgreeLink') !!}
                        </td>
                    </tr>
                    <tr style="display: none;" id="PrivateAlert">
                        <td>
                            <span class="alert-wrap alert-show">
                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                {{ trans('front.reservation.AgreeAlert') }}
                            </span>
                        </td>
                    </tr>
                </table>

                <a href="javascript:;" id="third-btn-back"><div class="btn btn-standard">{{ trans('front.reservation.prev') }}</div></a>
                <a href="javascript:;" id="third-btn"><div class="btn btn-standard">{{ trans('front.reservation.next') }}</div></a>
            </div>
            
            
            <div class="main-container" id="fourth-section" style="display: none;">
                <p style="max-width:350px;margin:0 auto;">
                    {{ trans('front.reservation.MakeSure') }}
                </p>
                <table class="confirm-table">
                    <tr>
                        <td>{{ trans('front.reservation.s2party') }}：</td>
                        <th id="PopCheck"></th>
                    </tr>
                    <tr>
                        <td>{{ trans('front.reservation.s2date') }}：</td>
                        <th id="ADayCheck"></th>
                    </tr>
                    <tr>
                        <td>{{ trans('front.reservation.s2time') }}：</td>
                        <th id="STimeCheck"></th>
                    </tr>
                    <tr>
                        <td>{{ trans('front.reservation.Name') }}：</td>
                        <th id="NameCheck"></th>
                    </tr>
                    <tr>
                        <td>{{ trans('front.reservation.Tel') }}：</td>
                        <th id="TelCheck"></th>
                    </tr>
                    <tr>
                        <td>Email：</td>
                        <th id="EMailCheck"></th>
                    </tr>
                    <tr>
                        <td>{{ trans('front.reservation.Main') }}：</td>
                        <th id="MealCheck"></th>
                    </tr>
                    <tr>
                        <td>{{ trans('front.reservation.Notes') }}：</td>
                        <th id="NotesCheck"></th>
                    </tr>
                </table>

                <a href="javascript:;" id="fourth-btn-back"><div style="height:54px;line-height:39px" class="btn btn-standard btn-pay btn-negative">{{ trans('front.reservation.prev') }}</div></a>
                <a href="javascript:;" id="fourth-btn-online"><div class="btn btn-standard btn-pay">{!! trans('front.reservation.Online') !!}<span id="CardView"></span></div></a>
                <a href="javascript:;" id="fourth-btn-onsite"><div class="btn btn-standard btn-pay btn-negative">{!! trans('front.reservation.Self') !!}<span id="MoneyView"></span></div></a>
            </div>
        

        	<div style="padding: 60px 15px 140px;display: none;" class="main-container" id="done-section">
                {!! trans('front.reservation.Done') !!}
            </div>
        </div>
<form name='Pay2go' method='post' id='Pay2Go' action='https://api.pay2go.com/MPG/mpg_gateway' data-backup='https://capi.pay2go.com/MPG/mpg_gateway'>
<input type="hidden" name="MerchantID" id="MerchantID" value="35699182">
<input type="hidden" name="RespondType" id="RespondType" value="JSON">
<input type="hidden" name="CheckValue" id="CheckValue">
<input type="hidden" name="TimeStamp" id="TimeStamp">
<input type="hidden" name="Version" id="Version" value="1.2">
<input type="hidden" name="LangType" id="LangType" value="zh-tw">
<input type="hidden" name="MerchantOrderNo" id="MerchantOrderNo">
<input type="hidden" name="Amt" id="Amt">
<input type="hidden" name="ItemDesc" id="ItemDesc">
<input type="hidden" name="TradeLimit" id="TradeLimit" value="600">
<input type="hidden" name="ReturnURL" id="ReturnURL" value="http://www.surpriselab.com.tw/dininginthedark/getPayDone">
<input type="hidden" name="ClientBackURL" id="ClientBackURL" value="http://www.surpriselab.com.tw/dininginthedark/">
<input type="hidden" name="Email" id="Email">
<input type="hidden" name="LoginType" id="LoginType" value="0">
<input type="hidden" name="OrderComment" id="OrderComment" value="無光晚餐">
</form>
	<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script src="/backstage/plugins/moment/moment.js"></script>
<!--script src="/backstage/plugins/timepicker/bootstrap-timepicker.min.js"></script-->
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.min.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.blockUI/2.70/jquery.blockUI.min.js"></script>
<style type="text/css">


.bootstrap-datetimepicker-widget table td.day {
  color:#000;
}
.bootstrap-datetimepicker-widget table td.disabled,
.bootstrap-datetimepicker-widget table td.disabled:hover {
  color: #F5F5F5;
}
#AID option:disabled {
    -webkit-border-radius:25px; -moz-border-radius:25px; border-radius:25px;
    color:red;
    /*background-color:red;*/
}
</style>
    <script type="text/javascript">
var spday = [],oneday = [];
$('#form_date').datetimepicker({
    format: "YYYY-MM-DD",
    minDate:'{{ Carbon\Carbon::today()->format('Y-m-d') }}',
    maxDate:'{{ config('setting.enddate') }}',
    daysOfWeekDisabled: [1],
    ignoreReadonly:true,
}).on('dp.change',function(event){
    $.get('/GetAjaxData',{'act':'GetActByDate','Day':event.date.format('YYYY-MM-DD')},function(data){
        $('#AID option').remove();
        $('#AID').append('<option value="">請選擇時段</option>');
        for(i=0;i<data.length;i++){
            var disable = '';
            var fulltxt = '';
            if(parseInt(data[i].Pople)<parseInt($("#Pople").val())){
                disable = 'disabled';
                fulltxt = '(額滿)';
            }
            $('#AID').append('<option value="'+data[i].AID+'" data-pople="'+data[i].Pople+'" data-one="'+data[i].One+'" data-sp="'+data[i].Sp+'" data-card="'+data[i].Card+'" data-money="'+data[i].Money+'" '+disable+'>'+data[i].STime.substr(0,5)+'-'+data[i].ETime.substr(0,5)+' '+fulltxt+'</option>');
        }
        if($('#AID').html()==''){ $('#AID').append('<option value="0">此日期無時段可供選擇</option>'); }
        $('#AIDAlert').hide();
    },'json');
}).on('dp.show',function(event){
    if(spday.length>0){
        for(i=0;i<spday.length;i++) $('.table-condensed tbody').find('[data-day="'+spday[i]+'"]').css('color','#F00');
    }
    if(oneday.length>0){
        for(i=0;i<oneday.length;i++) $('.table-condensed tbody').find('[data-day="'+oneday[i]+'"]').css('color','#00F');
        //$('.table-condensed tbody').find('[data-day="06/02/2016"]').css('color','#F00');
    }
});
$(function(){
    $.ajaxSetup({
        headers: {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        }
    });
    var showdate = [];
    $('.date_tr').hide();
    // 第一步
    $('#first-btn').bind('click',function(){
        console.log('');
        if($('#agree').prop('checked')){
            $('#agree-error').hide();
            ChangeSectionNav('second','first',1);
        } else {
            $('#agree-error').show();
        }
    });
    // 第二步
    $('#second-btn-back').bind('click',function(){
        ChangeSectionNav('first','second',0);
    });
    $('#second-btn').bind('click',function(){
        // 驗證選項
        var GoNext = 0;
        if($('#Pople').val()==0){
            $('#PopleAlert').show(); GoNext++;
        } else {
            $('#PopleAlert').hide();
        }
        if($('#AID').val()==0 || $('#AID option:selected').data('pople')<$('#Pople').val() || $('#AID').val()==null){
            $('#AIDAlert').show(); GoNext++;
        } else {
            $('#AIDAlert').hide();
        }
        if(GoNext==0){
            // creat table 
            var html = '<tr><td></td><th>{{ trans('front.reservation.Meal1') }}</th><th>{{ trans('front.reservation.Meal2') }}</th></tr>';
            for(i=0;i<$('#Pople').val();i++){
                var Num = i+1;
                html += '<tr><td>{{ trans('front.reservation.Customer') }}'+Num+'</td><th><input id="Pople_H'+Num+'" name="Pople['+Num+']" checked value="Hunsi" type="radio"><label for="Pople_H'+Num+'"><span></span></label></th><th><input id="Pople_V'+Num+'" name="Pople['+Num+']" type="radio" value="Vegetarian"><label for="Pople_V'+Num+'"><span></span></label></th></tr>';
            }
            $('#MealTable').html(html);
            ChangeSectionNav('third','second',2);
        }
    });

    // 第三步
    $('#third-btn-back').bind('click',function(){
        ChangeSectionNav('second','third',1);
    });
    $('#third-btn').bind('click',function(){
        // 驗證資料
        var GoNext = 0;
        if($('#Name').val()==''){ $('#NameAlert').show(); GoNext++; } else { $('#NameAlert').hide(); }
        if(validateTel($('#Tel').val())){ $('#TelAlert').show(); GoNext++; } else { $('#TelAlert').hide(); }
        if(!validateEmail($('#EMail').val())){ $('#EMailAlert').show(); GoNext++; } else { $('#EMailAlert').hide(); }
        if(!$('#privatecheck').prop('checked')){ $('#PrivateAlert').show(); GoNext++; } else { $('#PrivateAlert').hide(); }
        if(GoNext==0){
            $('#PopCheck').text($('#Pople').val());
            $('#ADayCheck').text($('#ADay').val());
            $('#STimeCheck').text($('#AID option:selected').text());
            $('#NameCheck').text($('#Name').val());
            $('#TelCheck').text($('#Tel').val());
            $('#EMailCheck').text($('#EMail').val());
            var text = '';
            for(i=0;i<$('input[value=Hunsi]').length;i++){
                text += text=='' ? '' : '/';
                var tmpval = i + 1;
                if($('#Pople_H'+tmpval).prop('checked')){
                    text += '{{ trans('front.reservation.Meal1') }}';
                } else {
                    text += '{{ trans('front.reservation.Meal2') }}';
                }
            }
            $('#MealCheck').text(text);
            $('#NotesCheck').text($('#Notes').val());
            $('#MoneyView').text($('#AID option:selected').data('money'));
            $('#CardView').text($('#AID option:selected').data('card'));
            ChangeSectionNav('fourth','third',3);
        }
    });

    // 第四步
    $('#fourth-btn-back').bind('click',function(){
        ChangeSectionNav('third','fourth',2);
    });
    $('#fourth-btn-onsite').bind('click',function(){
        // 送出資料
        SendOrderData('onsite');
    });
    $('#fourth-btn-online').bind('click',function(){
        // 轉到金流
        SendOrderData('online');
    });
    //$('#first-section').val();

    
    //$('#second-section,#third-section,#fourth-section,#done-section').hide();
    $('#Pople').bind('change',function(){
        var val = $(this).val();
        if(val>0){
            $('.date_tr').show();
        } else {
            $('.date_tr').hide();
        }
        $('#AID option').remove();
        $.get('/GetAjaxData',{'act':'GetActByPople','Pople':val},function(data){
            var nowdata = [];
            spday = [],oneday = [];
            for(i=0;i<data.length;i++){
                nowdata.push(data[i].ADay.replace(' 00:00:00',''));
                var tmp = data[i].ADay.replace(' 00:00:00','');
                tmp = tmp.replace('2016-','');
                tmp = tmp.replace('-','/');
                tmp = tmp+'/2016';
                if(parseInt(data[i].Sp)>0){
                   spday.push(tmp); 
                } 
                if(parseInt(data[i].One)>0){
                    oneday.push(tmp);
                }
            }
            if(nowdata.length>0){
                $('#form_date').data("DateTimePicker").enabledDates(nowdata);
                $('#form_date').data("DateTimePicker").date(nowdata[0]);
                showdate = nowdata;
            } else {
                $('#form_date').data("DateTimePicker").enabledDates(['{{ Carbon\Carbon::today()->format('Y-m-d') }}']);
            }
            $('#AIDAlert').hide();
            if(oneday.length==0 && val==1){
                $('#OneAlert').show();
            } else {
                $('#OneAlert').hide();
            }
        },'json');
    });

    $('#AID').bind('change',function(){
        if($('#AID option:selected').data('pople')>$('#Pople').val()){
            $('#AIDAlert').hide();
        }
    });
@if(!empty($success) && $success) ChangeSectionNav('done','first',4); @endif

});
function SendOrderData(Pay){
    $.blockUI();
    var Meal = [];
    for(i=0;i<$('input[value=Hunsi]').length;i++){
        var tmpval = i + 1;
        Meal[i] = $('#Pople_H'+tmpval).prop('checked') ? 'Hunsi' : 'Vegetarian';
    }
    var obj = {
        'Name'  : $('#Name').val(),
        'Tel'   : $('#Tel').val(),
        'EMail' : $('#EMail').val(),
        'Notes' : $('#Notes').val(),
        'Surprised' : $('#Surprised').val(),
        'AID'   : $('#AID').val(),
        'Pople' : $('#Pople').val(),
        'Meal'  : Meal,
        'Pay'   : Pay,
        'Lng'   : ''
    };
    $.post('/dininginthedark/ReOrderData',obj,function(data){
        if(data.success==true){
            if(Pay=='onsite'){ ChangeSectionNav('done','fourth',4); } else if(Pay=='online'){
                $('#Email').val($('#EMail').val());
                $('#CheckValue').val(data.CheckValue);
                $('#TimeStamp').val(data.TimeStamp);
                $('#MerchantOrderNo').val(data.SN);
                $('#Amt').val(data.Amt);
                $('#ItemDesc').val('無光晚餐'+$('#Pople').val()+'人套餐');
                /*console.log('test');
                $('#Pay2go').submit();*/
                document.forms["Pay2go"].submit();
                //$.unblockUI();
            }
        } else {
            alert('本場次人數已滿!');
            //$.unblockUI();
        }
        $.unblockUI();
    },'json').fail(function() {
    alert('服務繁忙中請稍後在試!');
    $.unblockUI();
  })
  .always(function() {
    
});
}





function ChangeSectionNav(show,hide,nav){
    $('.reservation-nav ul li').removeClass('active');
    $('.reservation-nav ul li:eq('+nav+')').addClass('active');
    $('#'+hide+'-section').hide();
    $('#'+show+'-section').show();
}
function validateEmail(email) {
    var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(email);
}
function validateTel(tel){
    if(tel==''){ return true; } else if(tel.length<9){ return true; } else if(tel.length>12) { return true; } else { return false; }
}
    </script>
@endsection